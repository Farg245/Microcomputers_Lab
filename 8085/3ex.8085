LXI B,01F4H ; KATHISTERISI 0,5 SEC
MVI E,01H ; E THESI TOU TRENOU
MOV A,E
CALL DELB 
CMA
STA 3000H ; PROTI THESI
          ; KSEKINAW APO TA DEKSIA PROS TA ARISTERA MIA KAI APO EKEI KSEKINAEI TO LEDAKI
ROTATE_LEFT:
	LDA 2000H ; FORTONW STON KATAXORITI TIN 2000H
					
	ANI 80H      ; ELEGXW AN TO MSB SWITCH EINAI ON , 
	CPI 80H    ; AN O KATAXORITIS EINAI ISOS ME 80H TO FLAG Z=1 
	JNZ ROTATE_LEFT  ; AN Z=1 PIDAME STO ROTATE LEFT

	
	LDA 2000H            ; ELEGXW AN EXE PATISEI TO KOUMPI
	ANI 01H		;AN VRISKOMASTE STO 1 LSB TOTE I KATEYTHINSI EINAI SOSTI
				;ALLIWS ALLAZW KATEUTHINSI
	
	JZ ROTATE_RIGHT_INVERSE

	MOV A,E ; FORTWNW THESI TRENOU STON KATAXORITI
							
	CPI 80H        ; OTAN FTASW ARISTERA ALLAZQ KATEUTHINSI PROS TA DEKSIA
	CALL DELB      ; KALO TIN DELB GIA TIN PRESET KATHISTERISI TWN 500ms 
	JZ ROTATE_RIGHT
	
	MOV A,E       ;     FORTWNW TIN THESI TOU TRENOU STON KATAXORITI
	RLC           ;     KANW TIN ARISTERI OLISTHISI
	MOV E,A       ;      OMOIOS ANANEWNW TIN THESI TOU TRENOU ME TIN THESI TOU KATAXORITI AFOU KANAME TIN OLISTHISI
	CMA           ; IPOLOGIZW TO COMPLEMENT TOU KATAXORITI
	STA 3000H     ; KAI TO EMFANIZW STA LEDAKIA
	CMA           ; KAI KSANAFERNW TON KATAXORITI STIN PROIGOUMENI MORFI TOU
	CALL DELB     ; KALW TIN DELB GIA TIN KATHISTERISI
	CPI 80H       ; SINEXIZW OSO DEN EXW FTASEI STO TELOS TIS OLISTHISIS PROS TA ARISTERA
				
	JNZ ROTATE_LEFT  ; SINEXIZW OSO DEN EXW FTASEI STO TELOS TIS OLISTHISIS PROS TA ARISTERA

	CALL DELB        ; OTAN FTASW STO TELOS TIS OLISTHISIS PROS TA DEKSIA KALW PALI TIN DELB
	JZ ROTATE_RIGHT  ;  KAI KANW ROTATE STA DEKSIA

ROTATE_RIGHT:
	LDA 2000H
	ANI 80H           ; ELEGXW AN TO MSB SWITCH EINAI ON 
	JZ ROTATE_RIGHT
	
	LDA 2000H
	ANI 01H              ;ELEGXW AN EXEI PATITHEI TO LSB SWITCH OSTE NA KSERW AN THA ALLAKSW KATEUTHINSI

	JZ ROTATE_LEFT_INVERSE
	
	MOV A,E
	CPI 01H       ; AN EXW FTASEI STO TELOS TIS DEKSIAS OLISTHISIS
	CALL DELB      ; KALO TIN DELB
	JZ ROTATE_LEFT    ; KAI ALLZW KATEUTHINSI
		
	
	MOV A,E   ; ALLIWS SINEXIZW OPOS KAI PIO PANW STI NROTATE LEFT
	RRC       ; KANW DEKSIA OLISTHISI
	MOV E,A
	CMA
	STA 3000H 
	CMA
	CALL DELB
	CPI 01H             
	JNZ ROTATE_RIGHT  ; OSO DEN EXW FTASEI STO TELOS TOU ROTATION SINEXIZW
	CALL DELB
	JZ ROTATE_LEFT


	

	
ROTATE_RIGHT_INVERSE:
	LDA 2000H
	ANI 80H   ; ELEGXO MSB
	JZ ROTATE_RIGHT_INVERSE
	
	LDA 2000H
	ANI 01H ; ELEGXO LSB SWITCH GIA NA DW AN PATITHIKE, SE EKEINI TIN PERIPTWSI GIRNAW ST OKANONIKO LEFT ROTATION
	JNZ ROTATE_LEFT
	
	MOV A,E
	CPI 01H     ; ELEGXO AN EXW FTASEI STO TELOS TIS DEKSIAS OLISTHISIS
	CALL DELB
	JZ ROTATE_LEFT_INVERSE  ; TOTE PAW STIN ARISTERI
	
	MOV A,E
	RRC
	MOV E,A
	CMA
	STA 3000H
	CMA
	CALL DELB
	CPI 01H
	JNZ ROTATE_RIGHT_INVERSE
	CALL DELB
	JZ ROTATE_LEFT_INVERSE
	
ROTATE_LEFT_INVERSE:
	LDA 2000H
	ANI 80H
	JZ ROTATE_LEFT_INVERSE
	
	LDA 2000H
	ANI 01H
	JNZ ROTATE_RIGHT

	MOV A,E
	CPI 80H
	CALL DELB
	JZ ROTATE_RIGHT_INVERSE
	
	MOV A,E
	RLC
	MOV E,A
	CMA 
	STA 3000H
	CMA
	CALL DELB
	CPI 80H
	JNZ ROTATE_LEFT_INVERSE
	CALL DELB
	JZ ROTATE_RIGHT_INVERSE
END
	
	
